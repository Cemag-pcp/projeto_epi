<tr id="setor-row-{{ setor.pk }}">
  <td>{{ setor.nome|default:"-" }}</td>
  <td>{{ setor.descricao|default:"-" }}</td>
  <td>
    {% if setor.responsaveis.exists %}
      {% for responsavel in setor.responsaveis.all %}
        {{ responsavel.nome }}{% if not forloop.last %}, {% endif %}
      {% endfor %}
    {% else %}
      -
    {% endif %}
  </td>
  <td>
    <span class="badge {% if setor.ativo %}bg-success-subtle text-success{% else %}bg-secondary-subtle text-secondary{% endif %}">
      {{ setor.ativo|yesno:"Ativo,Inativo" }}
    </span>
  </td>
  <td class="text-end">
    {% if perms.setores.change_setor or perms.setores.delete_setor %}
      {% if perms.setores.change_setor %}
      <button
        class="btn btn-outline-primary btn-icon"
        type="button"
        data-bs-toggle="modal"
        data-bs-target="#editModal-{{ setor.pk }}"
        title="Editar"
        aria-label="Editar"
      >
        <i class="bi bi-pencil"></i>
      </button>
      <form
        class="d-inline js-setor-toggle"
        id="setor-toggle-{{ setor.pk }}"
        method="post"
        action="{% url 'setores:toggle_active' setor.pk %}"
      >
        {% csrf_token %}
      </form>
      <button
        class="btn {% if setor.ativo %}btn-outline-danger{% else %}btn-outline-success{% endif %} btn-icon js-setor-toggle-trigger"
        type="button"
        data-bs-toggle="modal"
        data-bs-target="#setorToggleModal"
        data-form-id="setor-toggle-{{ setor.pk }}"
        data-nome="{{ setor.nome|escapejs }}"
        data-ativo="{{ setor.ativo|yesno:'1,0' }}"
        title="{% if setor.ativo %}Desativar{% else %}Ativar{% endif %}"
        aria-label="{% if setor.ativo %}Desativar{% else %}Ativar{% endif %}"
      >
        {% if setor.ativo %}
          <i class="bi bi-person-x"></i>
        {% else %}
          <i class="bi bi-person-check"></i>
        {% endif %}
      </button>
      {% endif %}
      {% if perms.setores.delete_setor %}
        <form
          class="d-inline js-setor-delete"
          id="setor-delete-{{ setor.pk }}"
          method="post"
          action="{% url 'setores:delete' setor.pk %}"
        >
          {% csrf_token %}
        </form>
        <button
          class="btn btn-outline-danger btn-icon js-setor-delete-trigger"
          type="button"
          data-bs-toggle="modal"
          data-bs-target="#setorDeleteModal"
          data-form-id="setor-delete-{{ setor.pk }}"
          data-nome="{{ setor.nome|escapejs }}"
          title="Excluir"
          aria-label="Excluir"
        >
          <i class="bi bi-trash"></i>
        </button>
      {% endif %}
    {% else %}
      <span class="text-muted">-</span>
    {% endif %}
  </td>
</tr>
