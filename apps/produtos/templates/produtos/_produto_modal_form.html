{% load l10n %}
<div class="modal fade" id="{{ modal_id }}" tabindex="-1" aria-labelledby="{{ modal_label_id }}" aria-hidden="true" data-produto-modal{% if prefix == "create" %} data-tabs-lock="1"{% endif %}{% if read_only %} data-readonly="1"{% endif %}>
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="{{ modal_label_id }}">{{ modal_title }}</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fechar"></button>
      </div>
      <div class="modal-body">
        <form method="post" action="{{ form_action }}" enctype="multipart/form-data">
          {% csrf_token %}
          {% if form.non_field_errors %}
            <div class="alert alert-danger py-2">
              {% for error in form.non_field_errors %}
                <div>{{ error }}</div>
              {% endfor %}
            </div>
          {% endif %}

          <ul class="nav nav-tabs mb-3" data-produto-tabs role="tablist">
            <li class="nav-item" role="presentation">
              <button class="nav-link active" id="tab-info-{{ prefix }}" data-bs-toggle="tab" data-bs-target="#tab-info-pane-{{ prefix }}" type="button" role="tab" aria-controls="tab-info-pane-{{ prefix }}" aria-selected="true">
                1. Informacoes basicas
              </button>
            </li>
            <li class="nav-item" role="presentation">
              <button class="nav-link" id="tab-outros-{{ prefix }}" data-bs-toggle="tab" data-bs-target="#tab-outros-pane-{{ prefix }}" type="button" role="tab" aria-controls="tab-outros-pane-{{ prefix }}" aria-selected="false">
                2. Estoque ideal
              </button>
            </li>
            <li class="nav-item" role="presentation">
              <button class="nav-link" id="tab-fornecedores-{{ prefix }}" data-bs-toggle="tab" data-bs-target="#tab-fornecedores-pane-{{ prefix }}" type="button" role="tab" aria-controls="tab-fornecedores-pane-{{ prefix }}" aria-selected="false">
                3. Fornecedores
              </button>
            </li>
            <li class="nav-item" role="presentation">
              <button class="nav-link" id="tab-anexos-{{ prefix }}" data-bs-toggle="tab" data-bs-target="#tab-anexos-pane-{{ prefix }}" type="button" role="tab" aria-controls="tab-anexos-pane-{{ prefix }}" aria-selected="false">
                4. Anexos
              </button>
            </li>
          </ul>

          <div class="tab-content">
            <div class="tab-pane fade show active" id="tab-info-pane-{{ prefix }}" role="tabpanel" aria-labelledby="tab-info-{{ prefix }}" tabindex="0">
              <div class="row g-3">
                <div class="col-12 col-sm-6 col-lg-3">
                  <label class="form-label" for="{{ form.codigo.id_for_label }}">{{ form.codigo.label }}{% if form.codigo.field.required %}<span class="text-danger"> *</span>{% endif %}</label>
                  {{ form.codigo }}
                  {% for error in form.codigo.errors %}
                    <div class="invalid-feedback d-block">{{ error }}</div>
                  {% endfor %}
                </div>
                <div class="col-12 col-lg-6">
                  <label class="form-label" for="{{ form.nome.id_for_label }}">{{ form.nome.label }}{% if form.nome.field.required %}<span class="text-danger"> *</span>{% endif %}</label>
                  {{ form.nome }}
                  {% for error in form.nome.errors %}
                    <div class="invalid-feedback d-block">{{ error }}</div>
                  {% endfor %}
                </div>
                <div class="col-12 col-sm-6 col-lg-3">
                  <label class="form-label" for="{{ form.referencia.id_for_label }}">{{ form.referencia.label }}{% if form.referencia.field.required %}<span class="text-danger"> *</span>{% endif %}</label>
                  {{ form.referencia }}
                  {% for error in form.referencia.errors %}
                    <div class="invalid-feedback d-block">{{ error }}</div>
                  {% endfor %}
                </div>
                <div class="col-12 col-sm-6 col-lg-3">
                  <label class="form-label" for="{{ form.ca.id_for_label }}">{{ form.ca.label }}{% if form.ca.field.required %}<span class="text-danger"> *</span>{% endif %}</label>
                  {{ form.ca }}
                  {% for error in form.ca.errors %}
                    <div class="invalid-feedback d-block">{{ error }}</div>
                  {% endfor %}
                  <div class="d-flex flex-wrap align-items-center gap-2 mt-1" data-ca-feedback>
                    <span class="badge d-none" data-ca-status data-ca-status-url="{% url 'produtos:ca_status_api' %}"></span>
                    <span class="text-muted small d-none" data-ca-status-text></span>
                  </div>
                </div>
                <div class="col-12 col-sm-6 col-lg-3">
                  <label class="form-label" for="{{ form.data_vencimento_ca.id_for_label }}">{{ form.data_vencimento_ca.label }}{% if form.data_vencimento_ca.field.required %}<span class="text-danger"> *</span>{% endif %}</label>
                  {{ form.data_vencimento_ca }}
                  {% for error in form.data_vencimento_ca.errors %}
                    <div class="invalid-feedback d-block">{{ error }}</div>
                  {% endfor %}
                </div>
                <div class="col-12 col-sm-6 col-lg-3">
                  <label class="form-label" for="fabricante-display-{{ prefix }}">{{ form.fabricante.label }}{% if form.fabricante.field.required %}<span class="text-danger"> *</span>{% endif %}</label>
                  <input
                    class="form-control"
                    id="fabricante-display-{{ prefix }}"
                    type="text"
                    value="{{ form.instance.fabricante|default:'' }}"
                    disabled
                    data-fabricante-display
                  >
                  {{ form.fabricante }}
                  {% for error in form.fabricante.errors %}
                    <div class="invalid-feedback d-block">{{ error }}</div>
                  {% endfor %}
                </div>
                <div class="col-12 col-sm-6 col-lg-3">
                  <label class="form-label" for="{{ form.periodicidade_quantidade.id_for_label }}">{{ form.periodicidade_quantidade.label }}{% if form.periodicidade_quantidade.field.required %}<span class="text-danger"> *</span>{% endif %}</label>
                  {{ form.periodicidade_quantidade }}
                  {% for error in form.periodicidade_quantidade.errors %}
                    <div class="invalid-feedback d-block">{{ error }}</div>
                  {% endfor %}
                </div>
                <div class="col-12 col-sm-6 col-lg-3">
                  <label class="form-label" for="{{ form.periodicidade.id_for_label }}">{{ form.periodicidade.label }}{% if form.periodicidade.field.required %}<span class="text-danger"> *</span>{% endif %}</label>
                  {{ form.periodicidade }}
                  {% for error in form.periodicidade.errors %}
                    <div class="invalid-feedback d-block">{{ error }}</div>
                  {% endfor %}
                </div>
                <div class="col-12 col-sm-6 col-lg-3">
                  <label class="form-label" for="{{ form.imposto_ipi.id_for_label }}">{{ form.imposto_ipi.label }}{% if form.imposto_ipi.field.required %}<span class="text-danger"> *</span>{% endif %}</label>
                  {{ form.imposto_ipi }}
                  {% for error in form.imposto_ipi.errors %}
                    <div class="invalid-feedback d-block">{{ error }}</div>
                  {% endfor %}
                </div>
                <div class="col-12 col-sm-6 col-lg-3">
                  <label class="form-label" for="{{ form.marca.id_for_label }}">{{ form.marca.label }}{% if form.marca.field.required %}<span class="text-danger"> *</span>{% endif %}</label>
                  {{ form.marca }}
                  {% for error in form.marca.errors %}
                    <div class="invalid-feedback d-block">{{ error }}</div>
                  {% endfor %}
                </div>
                <div class="col-12 col-sm-6 col-lg-3">
                  <label class="form-label" for="{{ form.unidade.id_for_label }}">{{ form.unidade.label }}{% if form.unidade.field.required %}<span class="text-danger"> *</span>{% endif %}</label>
                  {{ form.unidade }}
                  {% for error in form.unidade.errors %}
                    <div class="invalid-feedback d-block">{{ error }}</div>
                  {% endfor %}
                </div>
                <div class="col-12 col-sm-6 col-lg-3">
                  <label class="form-label" for="{{ form.tipo.id_for_label }}">{{ form.tipo.label }}{% if form.tipo.field.required %}<span class="text-danger"> *</span>{% endif %}</label>
                  {{ form.tipo }}
                  {% for error in form.tipo.errors %}
                    <div class="invalid-feedback d-block">{{ error }}</div>
                  {% endfor %}
                </div>
                <div class="col-12 col-sm-6 col-lg-3">
                  <label class="form-label" for="{{ form.familia.id_for_label }}">{{ form.familia.label }}{% if form.familia.field.required %}<span class="text-danger"> *</span>{% endif %}</label>
                  {{ form.familia }}
                  {% for error in form.familia.errors %}
                    <div class="invalid-feedback d-block">{{ error }}</div>
                  {% endfor %}
                </div>
                <div class="col-12 col-sm-6 col-lg-3">
                  <label class="form-label" for="{{ form.subfamilia.id_for_label }}">{{ form.subfamilia.label }}{% if form.subfamilia.field.required %}<span class="text-danger"> *</span>{% endif %}</label>
                  {{ form.subfamilia }}
                  {% for error in form.subfamilia.errors %}
                    <div class="invalid-feedback d-block">{{ error }}</div>
                  {% endfor %}
                </div>
                <div class="col-12 col-sm-6 col-lg-3">
                  <label class="form-label" for="{{ form.localizacao.id_for_label }}">{{ form.localizacao.label }}{% if form.localizacao.field.required %}<span class="text-danger"> *</span>{% endif %}</label>
                  {{ form.localizacao }}
                  {% for error in form.localizacao.errors %}
                    <div class="invalid-feedback d-block">{{ error }}</div>
                  {% endfor %}
                </div>
                <div class="col-12 col-sm-6 col-lg-3">
                  <label class="form-label" for="{{ form.dias_entrega.id_for_label }}">{{ form.dias_entrega.label }}{% if form.dias_entrega.field.required %}<span class="text-danger"> *</span>{% endif %}</label>
                  {{ form.dias_entrega }}
                  {% for error in form.dias_entrega.errors %}
                    <div class="invalid-feedback d-block">{{ error }}</div>
                  {% endfor %}
                </div>

                <div class="col-12 col-sm-6 col-lg-4">
                  <div class="form-check pt-2">
                    {{ form.monitora_uso }}
                    <label class="form-check-label" for="{{ form.monitora_uso.id_for_label }}">{{ form.monitora_uso.label }}{% if form.monitora_uso.field.required %}<span class="text-danger"> *</span>{% endif %}</label>
                    {% for error in form.monitora_uso.errors %}
                      <div class="invalid-feedback d-block">{{ error }}</div>
                    {% endfor %}
                  </div>
                </div>
                <div class="col-12 col-sm-6 col-lg-4">
                  <div class="form-check pt-2">
                    {{ form.troca_funcionario }}
                    <label class="form-check-label" for="{{ form.troca_funcionario.id_for_label }}">{{ form.troca_funcionario.label }}{% if form.troca_funcionario.field.required %}<span class="text-danger"> *</span>{% endif %}</label>
                    {% for error in form.troca_funcionario.errors %}
                      <div class="invalid-feedback d-block">{{ error }}</div>
                    {% endfor %}
                  </div>
                </div>
                <div class="col-12 col-sm-6 col-lg-4">
                  <div class="form-check pt-2">
                    {{ form.obrigar_entrega }}
                    <label class="form-check-label" for="{{ form.obrigar_entrega.id_for_label }}">{{ form.obrigar_entrega.label }}{% if form.obrigar_entrega.field.required %}<span class="text-danger"> *</span>{% endif %}</label>
                    {% for error in form.obrigar_entrega.errors %}
                      <div class="invalid-feedback d-block">{{ error }}</div>
                    {% endfor %}
                  </div>
                </div>
                <div class="col-12 col-sm-6 col-lg-4">
                  <div class="form-check pt-2">
                    {{ form.controle_epi }}
                    <label class="form-check-label" for="{{ form.controle_epi.id_for_label }}">{{ form.controle_epi.label }}{% if form.controle_epi.field.required %}<span class="text-danger"> *</span>{% endif %}</label>
                    {% for error in form.controle_epi.errors %}
                      <div class="invalid-feedback d-block">{{ error }}</div>
                    {% endfor %}
                  </div>
                </div>
                <div class="col-12 col-sm-6 col-lg-4">
                  <div class="form-check pt-2">
                    {{ form.ativo }}
                    <label class="form-check-label" for="{{ form.ativo.id_for_label }}">{{ form.ativo.label }}{% if form.ativo.field.required %}<span class="text-danger"> *</span>{% endif %}</label>
                    {% for error in form.ativo.errors %}
                      <div class="invalid-feedback d-block">{{ error }}</div>
                    {% endfor %}
                  </div>
                </div>
              </div>
              <div class="d-flex gap-2 justify-content-end mt-3">
                <button class="btn btn-primary" type="button" data-tab-next="#tab-outros-pane-{{ prefix }}">Continuar</button>
              </div>
            </div>

            <div class="tab-pane fade" id="tab-outros-pane-{{ prefix }}" role="tabpanel" aria-labelledby="tab-outros-{{ prefix }}" tabindex="0">
              <div class="row g-3">
                <div class="col-12 col-sm-6 col-lg-3">
                  <label class="form-label" for="{{ form.estoque_minimo.id_for_label }}">{{ form.estoque_minimo.label }}{% if form.estoque_minimo.field.required %}<span class="text-danger"> *</span>{% endif %}</label>
                  {{ form.estoque_minimo }}
                  {% for error in form.estoque_minimo.errors %}
                    <div class="invalid-feedback d-block">{{ error }}</div>
                  {% endfor %}
                </div>
                <div class="col-12 col-sm-6 col-lg-3">
                  <label class="form-label" for="{{ form.estoque_ideal.id_for_label }}">{{ form.estoque_ideal.label }}{% if form.estoque_ideal.field.required %}<span class="text-danger"> *</span>{% endif %}</label>
                  {{ form.estoque_ideal }}
                  {% for error in form.estoque_ideal.errors %}
                    <div class="invalid-feedback d-block">{{ error }}</div>
                  {% endfor %}
                </div>
                <div class="col-12 col-sm-6 col-lg-3">
                  <label class="form-label" for="{{ form.imposto_st.id_for_label }}">{{ form.imposto_st.label }}{% if form.imposto_st.field.required %}<span class="text-danger"> *</span>{% endif %}</label>
                  {{ form.imposto_st }}
                  {% for error in form.imposto_st.errors %}
                    <div class="invalid-feedback d-block">{{ error }}</div>
                  {% endfor %}
                </div>
                <div class="col-12 col-sm-6 col-lg-3">
                  <label class="form-label" for="{{ form.imposto_outros.id_for_label }}">{{ form.imposto_outros.label }}{% if form.imposto_outros.field.required %}<span class="text-danger"> *</span>{% endif %}</label>
                  {{ form.imposto_outros }}
                  {% for error in form.imposto_outros.errors %}
                    <div class="invalid-feedback d-block">{{ error }}</div>
                  {% endfor %}
                </div>
              </div>
              <div class="d-flex gap-2 justify-content-end mt-3">
                <button class="btn btn-outline-secondary" type="button" data-tab-prev="#tab-info-pane-{{ prefix }}">Voltar</button>
                <button class="btn btn-primary" type="button" data-tab-next="#tab-fornecedores-pane-{{ prefix }}">Continuar</button>
              </div>
            </div>

            <div class="tab-pane fade" id="tab-fornecedores-pane-{{ prefix }}" role="tabpanel" aria-labelledby="tab-fornecedores-{{ prefix }}" tabindex="0">
              <div class="d-flex flex-wrap gap-2 align-items-center justify-content-between mb-2">
                <div class="fw-semibold">Sessao de fornecedores</div>
                <button
                  class="btn btn-outline-primary btn-icon"
                  type="button"
                  data-fornecedor-add
                  title="Adicionar fornecedor"
                  aria-label="Adicionar fornecedor"
                >
                  <i class="bi bi-plus"></i>
                </button>
              </div>

              <div class="table-responsive">
                <table class="table table-sm align-middle">
                  <thead>
                    <tr>
                      <th scope="col">Dados do fornecedor</th>
                      <th scope="col" class="text-end">Acoes</th>
                    </tr>
                  </thead>
                  <tbody data-fornecedor-rows>
                    {% if fornecedores %}
                      {% for rel in fornecedores %}
                        <tr data-fornecedor-row>
                          <td>
                            <div class="d-flex align-items-center justify-content-between mb-2">
                              <span class="badge bg-secondary" data-fornecedor-label>Fornecedor</span>
                            </div>
                            <div class="row g-3">
                              <div class="col-12 col-md-6">
                                <label class="form-label small mb-1">Fornecedor</label>
                                <select class="form-select" data-field="fornecedor" name="fornecedores[{{ forloop.counter0 }}][fornecedor]">
                                  <option value="">Selecione</option>
                                  {% for fornecedor in form.fornecedor.field.queryset %}
                                    <option value="{{ fornecedor.pk }}"{% if fornecedor.pk == rel.fornecedor_id %} selected{% endif %}>{{ fornecedor }}</option>
                                  {% endfor %}
                                </select>
                              </div>
                              <div class="col-12 col-md-6">
                                <label class="form-label small mb-1">Codigo de barras</label>
                                <input class="form-control" type="text" data-field="codigo_barras" name="fornecedores[{{ forloop.counter0 }}][codigo_barras]" value="{{ rel.codigo_barras|default_if_none:'' }}">
                              </div>
                              <div class="col-12 col-md-6">
                                <label class="form-label small mb-1">Valor</label>
                                <input class="form-control" type="number" step="0.01" min="0" data-field="valor" name="fornecedores[{{ forloop.counter0 }}][valor]" value="{{ rel.valor|unlocalize|default_if_none:'' }}">
                              </div>
                              <div class="col-12 col-md-6">
                                <label class="form-label small mb-1">Fator de compra</label>
                                <input class="form-control" type="number" step="0.0001" min="0" data-field="fator_compra" name="fornecedores[{{ forloop.counter0 }}][fator_compra]" value="{{ rel.fator_compra|unlocalize|default_if_none:'' }}">
                              </div>
                              <div class="col-12 col-md-6">
                                <label class="form-label small mb-1">Codigo no fornecedor</label>
                                <input class="form-control" type="text" data-field="codigo_fornecedor" name="fornecedores[{{ forloop.counter0 }}][codigo_fornecedor]" value="{{ rel.codigo_fornecedor|default_if_none:'' }}">
                              </div>
                            </div>
                          </td>
                          <td class="text-end align-top">
                            <button
                              class="btn btn-outline-danger btn-icon mt-2"
                              type="button"
                              data-fornecedor-remove
                              title="Remover"
                              aria-label="Remover"
                            >
                              <i class="bi bi-trash"></i>
                            </button>
                          </td>
                        </tr>
                      {% endfor %}
                    {% else %}
                      <tr data-fornecedor-row>
                        <td>
                          <div class="d-flex align-items-center justify-content-between mb-2">
                            <span class="badge bg-secondary" data-fornecedor-label>Fornecedor</span>
                          </div>
                          <div class="row g-3">
                            <div class="col-12 col-md-6">
                              <label class="form-label small mb-1">Fornecedor</label>
                              <select class="form-select" data-field="fornecedor" name="fornecedores[0][fornecedor]">
                                <option value="">Selecione</option>
                                {% for fornecedor in form.fornecedor.field.queryset %}
                                  <option value="{{ fornecedor.pk }}">{{ fornecedor }}</option>
                                {% endfor %}
                              </select>
                            </div>
                            <div class="col-12 col-md-6">
                              <label class="form-label small mb-1">Codigo de barras</label>
                              <input class="form-control" type="text" data-field="codigo_barras" name="fornecedores[0][codigo_barras]" placeholder="Codigo de barras">
                            </div>
                            <div class="col-12 col-md-6">
                              <label class="form-label small mb-1">Valor</label>
                              <input class="form-control" type="number" step="0.01" min="0" data-field="valor" name="fornecedores[0][valor]" placeholder="0,00">
                            </div>
                            <div class="col-12 col-md-6">
                              <label class="form-label small mb-1">Fator de compra</label>
                              <input class="form-control" type="number" step="0.0001" min="0" data-field="fator_compra" name="fornecedores[0][fator_compra]" placeholder="1,0000">
                            </div>
                            <div class="col-12 col-md-6">
                              <label class="form-label small mb-1">Codigo no fornecedor</label>
                              <input class="form-control" type="text" data-field="codigo_fornecedor" name="fornecedores[0][codigo_fornecedor]" placeholder="Codigo interno">
                            </div>
                          </div>
                        </td>
                        <td class="text-end align-top">
                          <button
                            class="btn btn-outline-danger btn-icon mt-2"
                            type="button"
                            data-fornecedor-remove
                            title="Remover"
                            aria-label="Remover"
                          >
                            <i class="bi bi-trash"></i>
                          </button>
                        </td>
                      </tr>
                    {% endif %}
                  </tbody>
                </table>
              </div>

              <template data-fornecedor-template>
                <tr data-fornecedor-row>
                  <td>
                    <div class="d-flex align-items-center justify-content-between mb-2">
                      <span class="badge bg-secondary" data-fornecedor-label>Fornecedor</span>
                    </div>
                    <div class="row g-3">
                      <div class="col-12 col-md-6">
                        <label class="form-label small mb-1">Fornecedor</label>
                        <select class="form-select" data-field="fornecedor" name="fornecedores[__index__][fornecedor]">
                          <option value="">Selecione</option>
                          {% for fornecedor in form.fornecedor.field.queryset %}
                            <option value="{{ fornecedor.pk }}">{{ fornecedor }}</option>
                          {% endfor %}
                        </select>
                      </div>
                      <div class="col-12 col-md-6">
                        <label class="form-label small mb-1">Codigo de barras</label>
                        <input class="form-control" type="text" data-field="codigo_barras" name="fornecedores[__index__][codigo_barras]" placeholder="Codigo de barras">
                      </div>
                      <div class="col-12 col-md-6">
                        <label class="form-label small mb-1">Valor</label>
                        <input class="form-control" type="number" step="0.01" min="0" data-field="valor" name="fornecedores[__index__][valor]" placeholder="0,00">
                      </div>
                      <div class="col-12 col-md-6">
                        <label class="form-label small mb-1">Fator de compra</label>
                        <input class="form-control" type="number" step="0.0001" min="0" data-field="fator_compra" name="fornecedores[__index__][fator_compra]" placeholder="1,0000">
                      </div>
                      <div class="col-12 col-md-6">
                        <label class="form-label small mb-1">Codigo no fornecedor</label>
                        <input class="form-control" type="text" data-field="codigo_fornecedor" name="fornecedores[__index__][codigo_fornecedor]" placeholder="Codigo interno">
                      </div>
                    </div>
                  </td>
                  <td class="text-end align-top">
                    <button
                      class="btn btn-outline-danger btn-icon mt-2"
                      type="button"
                      data-fornecedor-remove
                      title="Remover"
                      aria-label="Remover"
                    >
                      <i class="bi bi-trash"></i>
                    </button>
                  </td>
                </tr>
              </template>
              <div class="d-flex gap-2 justify-content-end mt-3">
                <button class="btn btn-outline-secondary" type="button" data-tab-prev="#tab-outros-pane-{{ prefix }}">Voltar</button>
                <button class="btn btn-primary" type="button" data-tab-next="#tab-anexos-pane-{{ prefix }}">Continuar</button>
              </div>
            </div>

            <div class="tab-pane fade" id="tab-anexos-pane-{{ prefix }}" role="tabpanel" aria-labelledby="tab-anexos-{{ prefix }}" tabindex="0">
              <div class="d-flex flex-wrap gap-2 align-items-center justify-content-between mb-2">
                <div class="fw-semibold">Anexos do produto</div>
                <button
                  class="btn btn-outline-primary btn-icon"
                  type="button"
                  data-anexo-add
                  title="Adicionar anexo"
                  aria-label="Adicionar anexo"
                >
                  <i class="bi bi-plus"></i>
                </button>
              </div>

              <div class="table-responsive">
                <table class="table table-sm align-middle">
                  <thead>
                    <tr>
                      <th scope="col">Arquivo</th>
                      <th scope="col">Descricao</th>
                      <th scope="col" class="text-end">Acoes</th>
                    </tr>
                  </thead>
                  <tbody data-anexo-rows>
                    {% if anexos %}
                      {% for anexo in anexos %}
                        <tr data-anexo-row>
                          <td>
                            {% if anexo.arquivo %}
                              <div class="small mb-1">
                                <a href="{{ anexo.arquivo.url }}" target="_blank" rel="noopener">{{ anexo.arquivo.name }}</a>
                              </div>
                            {% endif %}
                            <input class="form-control" type="file" data-field="arquivo">
                            <input type="hidden" data-field="id" value="{{ anexo.pk }}">
                          </td>
                          <td>
                            <input class="form-control" type="text" data-field="descricao" value="{{ anexo.descricao|default_if_none:'' }}">
                          </td>
                          <td class="text-end">
                            <button
                              class="btn btn-outline-danger btn-icon"
                              type="button"
                              data-anexo-remove
                              title="Remover"
                              aria-label="Remover"
                            >
                              <i class="bi bi-trash"></i>
                            </button>
                          </td>
                        </tr>
                      {% endfor %}
                    {% else %}
                      <tr data-anexo-row>
                        <td>
                          <input class="form-control" type="file" data-field="arquivo">
                        </td>
                        <td>
                          <input class="form-control" type="text" data-field="descricao" placeholder="Descricao do anexo">
                        </td>
                        <td class="text-end">
                          <button
                            class="btn btn-outline-danger btn-icon"
                            type="button"
                            data-anexo-remove
                            title="Remover"
                            aria-label="Remover"
                          >
                            <i class="bi bi-trash"></i>
                          </button>
                        </td>
                      </tr>
                    {% endif %}
                  </tbody>
                </table>
              </div>

              <template data-anexo-template>
                <tr data-anexo-row>
                  <td>
                    <input class="form-control" type="file" data-field="arquivo">
                  </td>
                  <td>
                    <input class="form-control" type="text" data-field="descricao" placeholder="Descricao do anexo">
                  </td>
                  <td class="text-end">
                    <button
                      class="btn btn-outline-danger btn-icon"
                      type="button"
                      data-anexo-remove
                      title="Remover"
                      aria-label="Remover"
                    >
                      <i class="bi bi-trash"></i>
                    </button>
                  </td>
                </tr>
              </template>
              <div class="d-flex gap-2 justify-content-end mt-3">
                <button class="btn btn-outline-secondary" type="button" data-tab-prev="#tab-fornecedores-pane-{{ prefix }}">Voltar</button>
                <button class="btn btn-primary" type="submit">Salvar</button>
              </div>
            </div>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>
